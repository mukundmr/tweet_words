
<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="import" href="bower_components/polymer/polymer.html">
    <link rel="import" href="bower_components/core-toolbar/core-toolbar.html">
    <link rel="import" href="bower_components/core-header-panel/core-header-panel.html">
    <link rel="import" href="bower_components/core-icons/core-icons.html">
    <link rel="import" href="bower_components/core-drawer-panel/core-drawer-panel.html">
    <link rel="import" href="bower_components/paper-icon-button/paper-icon-button.html">
    <link rel="import" href="bower_components/core-item/core-item.html">

    <link rel="import" href="elements/tw-menu.html">
    <link rel="import" href="elements/tw-paper-input.html">
    

  </head>
  <style>
        body {
          font-family: sans-serif;
          flex-direction: row;
        }
        core-header-panel {
          background: white;
        }
        core-toolbar {
          background-color: cadetblue;
          color: antiquewhite;
          height: 144px;
        }
        p {
          margin: 20px;
          padding: 10px 20px;
          border-radius: 20px;
          background-color: #eee;
        }
        core-header-panel {
          background: white;
        }
        tw-menu {
          float: left;
          display: block;
          margin: 12px;
          width: 100%;
        }
        .keyword {
            background: whitesmoke;
            padding-left: 10px;
            color: cadetblue;
            margin-top: 5px;
        }
        .keyword:hover {
            background: antiquewhite;
            color: cornflowerblue;
        }
        .Negative {
          background-color: lemonchiffon;
        }
       .Positive {
          background-color: skyblue;
        }

        #tweets {
            margin: 64px 120px 60px 5px;
            background-color: #fff;
            box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
            border-radius: 2px;
            float: left;
            width: 90%;
            min-height: 500px;
        }

  </style>
  <body fullbleed vertical layout unresolved style="flex-direction: row;">
  <core-drawer-panel drawerwidth="300px">
      <core-header-panel drawer flex>
        <core-toolbar id="mainheader">
          <span flex style="margin-top: 12%; padding-left: 10px;">Tweet Words</span>
        </core-toolbar>
        <tw-menu id="menu" selected="0">
        <!-- TODO (vin18) Correct this; currently nothing is displayed  -->
          <core-item  id='search'>
            <tw-paper-input label="Search"></tw-paper-input>
          </core-item>
          {{range $i := .KeywordsSearched}}
            <core-item class="keyword" label="{{html $i}}">
               <a href="/GetKeywordsServ?keyword={{html $i}}"></a>
            </core-item>
          {{end}}
        </tw-menu>
      </core-header-panel>


      <core-header-panel main shadow flex mode="cover">
        <core-toolbar id="mainheader">
        </core-toolbar>
        <div id="tweets" >
        <div>
      </core-header-panel>

  </core-drawer-panel>

  <!-- Support for web components technologies if not natively supported -->
  <script src="bower_components/webcomponentsjs/webcomponents.min.js"></script>


  <script type="text/javascript">

      function getQueryVariable(variable)
      {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
          var pair = vars[i].split("=");
          if(pair[0] == variable)
            {
              return pair[1];
            }
        }   
        return(false);
      }

      streamUrl = getQueryVariable('keyword');
      if(streamUrl)
      {
          streamUrl= streamUrl.replace('%20','+')

          var source = new EventSource('/' + streamUrl);
          // Create a callback for when a new message is received.
          source.onmessage = function(e) {
            var tweetDiv = document.getElementById('tweets');
            var tweet = document.createElement('p');
            var sse = JSON.parse(e.data);
            tweet.innerText = sse.text
            tweet.classList.add(sse.class)
            tweetDiv.appendChild(tweet)
          };
          source.onerror = function(e) {
            console.log(e)
          };

      }
      
  </script>
</body>
</html>
